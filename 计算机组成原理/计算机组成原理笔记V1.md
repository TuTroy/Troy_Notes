# I/O设备

I/O系统由I/O软件和I/O硬件组成。

I/O软件：驱动程序--采用I/O指令和通道指令实现CPU和I/O设备的信息交换。

I/O硬件：设备控制器来控制设备具体操作，I/O接口与主机总线相连。

I/O控制方式：程序查询、程序中断、DMA方式和通道方式。

显示器：

- 屏幕大小、分辨率、灰度级、刷新频率和显示存储器(VRAM)

- VRAM容量=分辨率*灰度级**位数**

- VRAM带宽=容量*帧频

打印机：

- 工作方式分：针式打印机（票据）、喷模式打印机、激光打印机
- 原理分：击打式和非击打式
- 能否打汉字：点阵式和活字式



## I/O接口

I/O接口作用

- 数据缓冲：通过数据缓冲寄存器（DBR）达到主机和外设工作速度的匹配
- 错误或状态监测：通过**状态寄存器**反馈设备的各种错误、状态信息，供CPU查用
- 控制和定时：接收从控制总线发来的控制信号、时钟信号
- 数据格式转换：串-并、并-串 等格式转换
- 与主机和设备通信：实现 主机—I/O接口—I/O设备 之间的通信

![image-20230907164812289](images/image-20230907164812289.png)

模拟CPU控制打印机：【状态/控制寄存器】- 两个寄存器合为一个，因为两种不一起使用可以合一起

1.通过数据线向【状态/控制寄存器】中的的状态寄存器发送命令字(控制字，一串二进制)存储，然后通过【I/O控制逻辑】对命令读取执行，此时通过打印机接口启动了打印机并且将打印机状态存到【状态/控制寄存器】。

2.CPU对【状态/控制寄存器】进行状态检测，如果打印机准备就绪，就向数据缓冲寄存器中输入数据，同样数据在【I/O控制逻辑】的作用下对打印机进行数据传输（匹配速度）。

3.打印机完成后会向控制寄存器中反馈信息，CPU通过读取状态寄存器检测传输完成

- 对应对I/O方式
- CPU一直轮询的检测状态寄存器
- 通过控制线向CPU发一个中断请求信号
  - 说明：打印机发出的中断可以是完成后的请求也可能是设备故障的请求，这时候打印机同时会向数据缓冲寄存器中发送一个【中断类型号】，CPU结合发过来的中断信号进行不同的处理

4.一个I/O接口可以对应多台打印机，那么需要通过通过【地址线】发送【地址码】进行【地址译码】选择打印机

- I/O接口中的**各种寄存器就是I/O端口**
- CPU对端口的操作：数据端口-读写，状态端口-读，控制端口-写



串行：**一位**一位的传（USB）

**并行**：一个字节或一个字所有位一起传输

ASCII7位+1位奇偶验证码，故键盘的缓冲区DBR一般式8位。 其他情况若涉及到起始位则再+2.



| 统一编址                           | 独立编址                                    |
| :--------------------------------- | :------------------------------------------ |
| 访存指令访问                       | 专门的I/O指令                               |
| 靠地址码区分内存和设备             | 靠指令区分内存和设备                        |
| 占用主存地址空间，主存地址空间变小 | 不占用主存地址空间，地址位数少，译码快      |
| 较大的编编址空间，读写控制电路简单 | I/O指令少，只能对端口读写，程序设计灵活性差 |
| 内存地址和I/O地址不同              | 内存地址和I/O地址可能相同                   |

I/O指令只能在OS内核中使用，属于特权指令。通常是对数据、状态控制寄存器的访问操作，实现的数据传输发生在CPU的通用寄存器和I/O端口之间。

磁盘驱动器不是I/O接口